<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Umrah Duas" />

  <link rel="manifest" href="manifest.webmanifest" />

  <title>Umrah Duas</title>

  <!-- Noto Naskh Arabic (nice on iOS) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;600&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Calm, consistent dark theme */
      --bg0: #0b1220;
      --bg1: #070c16;

      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.08);

      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.62);
      --border: rgba(255,255,255,.14);

      --accent: #7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;

      --shadow: 0 10px 26px rgba(0,0,0,.30);
      --radius: 18px;

      --safeTop: env(safe-area-inset-top);
      --safeBottom: env(safe-area-inset-bottom);
      --safeLeft: env(safe-area-inset-left);
      --safeRight: env(safe-area-inset-right);

      --arabicSize: 22px;
      --bodySize: 14px;
    }

    [data-theme="light"]{
      /* Soft light theme */
      --bg0: #f6f7fb;
      --bg1: #eef1f7;

      --card: rgba(14,23,42,.05);
      --card2: rgba(14,23,42,.07);

      --text: rgba(14,23,42,.92);
      --muted: rgba(14,23,42,.60);
      --border: rgba(14,23,42,.12);

      --shadow: 0 10px 24px rgba(14,23,42,.14);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      font-size: var(--bodySize);
      letter-spacing: .1px;

      /* Calmer + consistent background (less patchy than before) */
      background:
        radial-gradient(900px 600px at 15% 0%, rgba(125,211,252,.10), transparent 60%),
        radial-gradient(900px 600px at 85% 10%, rgba(167,139,250,.08), transparent 58%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 100%);
      background-attachment: fixed;
    }

    .app{
      min-height:100%;
      padding: calc(16px + var(--safeTop)) calc(14px + var(--safeLeft)) calc(90px + var(--safeBottom)) calc(14px + var(--safeRight));
      max-width: 920px;
      margin: 0 auto;
    }

    header{
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      margin-bottom: 14px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .brand h1{
      margin:0;
      font-size: 20px;
      line-height:1.1;
      letter-spacing:.2px;
    }
    .brand .sub{
      color:var(--muted);
      font-size:12px;
      line-height:1.3;
      max-width: 46ch;
    }

    .pillrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: 999px;
      padding: 9px 12px;
      box-shadow: var(--shadow);
      color: var(--text);
      display:flex;
      gap:8px;
      align-items:center;
      user-select:none;
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .pill{
      background: rgba(255,255,255,.70);
    }

    .pill button{
      all:unset;
      cursor:pointer;
      padding: 0 2px;
      color: var(--text);
      font-weight:600;
      font-size:12px;
      opacity:.95;
    }
    .pill .mini{
      all:unset;
      cursor:pointer;
      color: var(--muted);
      font-size:12px;
      padding: 0 2px;
    }

    .searchbar{
      display:flex;
      gap:10px;
      align-items:center;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius);
      padding: 10px 12px;
      box-shadow: var(--shadow);
      margin-bottom: 12px;
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .searchbar{
      background: rgba(255,255,255,.75);
    }

    .searchbar input{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      color: var(--text);
      font-size: 14px;
    }
    .searchbar input::placeholder{ color: var(--muted); }

    .chiprow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin: 10px 0 14px;
    }
    .chip{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 999px;
      padding: 8px 10px;
      font-size:12px;
      color: var(--muted);
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .18s ease, border-color .18s ease;
    }
    [data-theme="light"] .chip{
      background: rgba(255,255,255,.65);
    }

    .chip:active{ transform: scale(.98); }
    .chip[data-active="true"]{
      background: linear-gradient(135deg, rgba(125,211,252,.16), rgba(167,139,250,.12));
      color: var(--text);
      border-color: rgba(125,211,252,.35);
    }

    .list{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    /* More consistent, less "stripy" cards */
    .card{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .card{
      background: rgba(255,255,255,.78);
    }

    .cardTop{
      padding: 14px 14px 0;
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
    }
    .meta{ min-width:0; }
    .section{
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 6px;
      letter-spacing:.6px;
      text-transform: uppercase;
    }
    .title{
      margin:0 0 10px;
      font-size: 15px;
      font-weight: 700;
      line-height:1.25;
    }
    .actions{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .iconBtn{
      width:38px; height:38px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .18s ease;
    }
    [data-theme="light"] .iconBtn{
      background: rgba(255,255,255,.70);
    }
    .iconBtn:hover{ background: rgba(255,255,255,.07); }
    .iconBtn:active{ transform: scale(.98); }
    .iconBtn svg{ opacity:.92; }

    .content{ padding: 0 14px 14px; }

    .label{
      font-size: 11px;
      color: var(--muted);
      letter-spacing:.6px;
      text-transform: uppercase;
      margin: 10px 0 6px;
    }

    .arabic{
      font-family: "Noto Naskh Arabic", "Noto Sans Arabic", Arial, sans-serif;
      font-size: var(--arabicSize);
      direction: rtl;
      text-align: right;
      line-height:1.65;
      margin: 0;
      unicode-bidi: isolate-override;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid var(--border);

      /* calmer panel */
      background: rgba(0,0,0,.14);
    }
    [data-theme="light"] .arabic{
      background: rgba(14,23,42,.045);
    }

    .text{
      margin:0;
      color: var(--text);
      line-height:1.55;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.10);
    }
    [data-theme="light"] .text{
      background: rgba(14,23,42,.035);
    }

    .notes{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.45;
    }

    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(14px + var(--safeBottom));
      background: rgba(0,0,0,.75);
      color: #fff;
      border:1px solid rgba(255,255,255,.18);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-2px);
    }

    .footerDock{
      position: fixed;
      left: 0; right: 0;
      bottom: 0;
      padding: 10px calc(14px + var(--safeLeft)) calc(10px + var(--safeBottom)) calc(14px + var(--safeRight));
      display:flex;
      justify-content:center;
      pointer-events:none;

      /* calmer dock fade */
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.18) 40%, rgba(0,0,0,.42));
    }
    [data-theme="light"] .footerDock{
      background: linear-gradient(180deg, transparent, rgba(246,247,251,.70) 45%, rgba(246,247,251,.92));
    }

    .dockInner{
      pointer-events:auto;
      width:min(920px, 100%);
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: 20px;
      padding: 10px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .dockInner{
      background: rgba(255,255,255,.82);
    }

    .dockLeft{
      display:flex;
      gap:10px;
      align-items:center;
      min-width:0;
    }
    .statusDot{
      width:10px; height:10px;
      border-radius: 50%;
      background: rgba(255,255,255,.25);
      border:1px solid rgba(255,255,255,.25);
      flex: 0 0 auto;
    }
    .statusDot.online{ background: var(--good); border-color: rgba(52,211,153,.55); }
    .statusText{
      font-size: 12px;
      color: var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 48vw;
    }
    .dockRight{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .dockBtn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 9px 10px;
      font-size:12px;
      color: var(--text);
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .18s ease;
      font-weight: 700;
    }
    [data-theme="light"] .dockBtn{
      background: rgba(255,255,255,.70);
    }
    .dockBtn:hover{ background: rgba(255,255,255,.07); }
    .dockBtn:active{ transform: scale(.98); }

    .hint{
      margin-top: 12px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.45;
    }
    .hint strong{ color: var(--text); }

    .empty{
      border:1px dashed var(--border);
      border-radius: 22px;
      padding: 18px 14px;
      text-align:center;
      color: var(--muted);
    }

    @media (min-width: 860px){
      .list{ grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="brand">
        <h1>Umrah Duas</h1>
        <div class="sub">Search, favourite, adjust Arabic size — and add to Home Screen for offline use on iOS.</div>
      </div>

      <div class="pillrow">
        <div class="pill" title="Font sizes">
          <button id="arabicMinus" aria-label="Arabic smaller">A−</button>
          <button id="arabicPlus" aria-label="Arabic bigger">A+</button>
          <span style="width:1px;height:16px;background:var(--border);display:inline-block;"></span>
          <button id="bodyMinus" class="mini" aria-label="Text smaller">a−</button>
          <button id="bodyPlus" class="mini" aria-label="Text bigger">a+</button>
        </div>

        <div class="pill" title="Theme">
          <button id="themeToggle">Dark</button>
        </div>
      </div>
    </header>

    <div class="searchbar">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="2" opacity=".8"/>
        <path d="M16.5 16.5 21 21" stroke="currentColor" stroke-width="2" opacity=".8" stroke-linecap="round"/>
      </svg>
      <input id="q" type="search" placeholder="Search: tawaf, zamzam, labbayk, fire, mercy…" autocomplete="off" />
    </div>

    <div class="chiprow" id="chips"></div>

    <div class="list" id="list"></div>

    <div class="hint">
      <strong>Tip:</strong> On iPhone, open this in <strong>Safari</strong> → Share → <strong>Add to Home Screen</strong>.
      Once installed, it opens full-screen like an app.
    </div>
  </div>

  <div class="footerDock" role="presentation">
    <div class="dockInner">
      <div class="dockLeft">
        <div id="netDot" class="statusDot"></div>
        <div id="netText" class="statusText">Checking offline status…</div>
      </div>
      <div class="dockRight">
        <button id="showFavs" class="dockBtn">Favourites</button>
        <button id="showAll" class="dockBtn">All</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Copied</div>

  <script>
    // --- Data (duas extracted from your guide) ---
    const DUAS = [
      {
        id: "niyyah-1",
        section: "Ihram / Miqat",
        title: "Niyyah for Umrah (Option 1)",
        arabic: "لَبَّيْكَ اَللَّهُمَّ عُمْرَةً",
        translit: "Labbayka Llāhumma ʿUmrah.",
        meaning: "O Allah, here I am to perform Umrah.",
        notes: ""
      },
      {
        id: "niyyah-2",
        section: "Ihram / Miqat",
        title: "Niyyah for Umrah (Option 2)",
        arabic: "اَللَّهُمَّ إِنِّي أُرِيدُ الْعُمْرَةَ",
        translit: "Allāhumma innī urīdu l-ʿUmrah.",
        meaning: "O Allah, I intend to perform Umrah.",
        notes: ""
      },
      {
        id: "niyyah-3",
        section: "Ihram / Miqat",
        title: "Niyyah for Umrah (Option 3 — easiest to use)",
        arabic: "اَللَّهُمَّ إِنِّي أُرِيدُ الْعُمْرَةَ فَيَسِّرْهَا لِي وَتَقَبَّلْهَا مِنِّي",
        translit: "Allāhumma innī urīdu l-ʿUmrata fa yassirhā lī wa taqabbalhā minnī.",
        meaning: "O Allah, I intend to perform Umrah, so make it easy for me and accept it from me.",
        notes: ""
      },
      {
        id: "talbiyah",
        section: "Ihram / Miqat",
        title: "Talbiyah",
        arabic: "لَبَّيْكَ اَللَّهُمَّ لَبَّيْكَ – لَبَّيْكَ لَا شَرِيكَ لَكَ لَبَّيْكَ – إِنَّ الْحَمْدَ وَالنِّعْمَةَ لَكَ وَالْمُلْكَ – لَا شَرِيكَ لَكَ –",
        translit: "Labbayka Llāhumma labbayk, labbayka lā sharīka laka labbayk, inna l-ḥamda wa n-niʿmata, laka wa l-mulk, lā sharīka lak.",
        meaning: "At Your service, O Allah, at Your service. At Your service, You have no partner, at Your service. Truly all praise and favour are Yours, and sovereignty. You have no partner.",
        notes: "Repeat often until you reach the mosque (per the guide)."
      },
      {
        id: "haram-boundary",
        section: "Entering Makkah",
        title: "Entering the Haram boundary",
        arabic: "اَللَّهُمَّ هَذَا حَرَمُكَ وَأَمْنُكَ فَحَرِّمْنِي عَلَى النَّارِ ❁ وَأَمِنِّي مِنْ عَذَابِكَ يَوْمَ تَبْعَثُ عِبَادَكَ ❁ وَاجْعَلْنِي مِنْ أَوْلِيَائِكَ وَأَهْلِ طَاعَتِكَ",
        translit: "Allāhumma hādhā ḥaramuka wa amnuka fa ḥarrimnī ʿala n-nār, wa aminnī min ʿadhābika yawma tabʿathu ʿibādak, wa jʿalnī min awliyā’ika wa ahli ṭāʿatik.",
        meaning: "O Allah, this is Your sanctuary and Your security, so make me forbidden for the Fire. Make me safe from Your punishment on the Day You resurrect Your servants, and make me among Your allies (friends) and among the people who obey You.",
        notes: ""
      },
      {
        id: "enter-masjid-1",
        section: "Masjid al-Haram",
        title: "Entering the mosque",
        arabic: "بِسْمِ اللهِ ❁ اَللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ ❁ اللّٰهُمَّ اغْفِرْ لِي وَافْتَحْ لِي أَبْوَابَ رَحْمَتِكَ",
        translit: "Bismi Llāh. Allāhumma ṣalli ʿalā Muḥammad. Allāhumma-ghfir lī wa-ftaḥ lī abwāba raḥmatik.",
        meaning: "In the name of Allah. O Allah, send prayers and peace upon Muhammad. O Allah, forgive me and open for me the doors of Your mercy.",
        notes: "Enter with the right foot."
      },
      {
        id: "enter-masjid-2",
        section: "Masjid al-Haram",
        title: "Protection from Shaytan (entering mosque)",
        arabic: "أَعُوذُ بِاللهِ الْعَظِيمِ ❁ وَبِوَجْهِهِ الْكَرِيمِ ❁ وَسُلْطَانِهِ الْقَدِيمِ ❁ مِنَ الشَّيْطَانِ الرَّجِيمِ",
        translit: "Aʿūdhu bi-Llāhi l-aẓīm, wa bi-wajhihi l-karīm, wa sulṭānihi l-qadīm, mina sh-shayṭāni r-rajīm.",
        meaning: "I seek refuge in Allah, the Magnificent, and in His Noble Face, and in His Eternal Authority, from Satan, the accursed.",
        notes: ""
      },
      {
        id: "first-sight-1",
        section: "First sight of Kaaba",
        title: "On first sight of the Kaaba (x3)",
        arabic: "اللّٰهُ أَكْبَرُ ❁ اللّٰهُ أَكْبَرُ ❁ لَآ اِلَهَ اِلَّا اللّٰهُ",
        translit: "Allāhu akbar. Allāhu akbar. Lā ilāha illa Llāh.",
        meaning: "Allah is the Greatest. Allah is the Greatest. There is no deity except Allah.",
        notes: "Guide note: recite 3 times, then make du’a."
      },
      {
        id: "first-sight-2",
        section: "First sight of Kaaba",
        title: "Du’a: increase this House in honour",
        arabic: "اَللَّهُمَّ زِدْ هَذَا الْبَيْتَ تَشْرِيفاً وَتَعْظِيماً وَتَكْرِيماً وَمَهَابَةً ❁ وَزِدْ مَنْ شَرَّفَهُ وَكَرَّمَهُ مِمَّنْ حَجَّهُ أَوْ اعْتَمَرَهُ تَشْرِيفاً وَتَكْرِيماً وَتَعْظِيماً وَبِرّاً",
        translit: "Allāhumma zid hādha l-bayta tashrīfan wa taʿẓīman wa takrīman wa mahābah, wa zid man sharrafahu wa karramahu mimman ḥajjahu aw iʿtamarahu tashrīfan wa takrīman wa taʿẓīman wa birrā.",
        meaning: "O Allah, increase this House in honour, dignity, nobility and awe. And increase those who honour and revere it, from among those who perform Hajj or Umrah, in honour, dignity, nobility and righteousness.",
        notes: ""
      },
      {
        id: "first-sight-3",
        section: "First sight of Kaaba",
        title: "Du’a: Allah, You are Peace",
        arabic: "اَللَّهُمَّ أَنْتَ السَّلاَمُ ❁ وَمِنْكَ السَّلَامُ ❁ حَيِّنَا رَبَّنَا بِالسَّلاَمِ",
        translit: "Allāhumma anta s-salām, wa minka s-salām, ḥayyinā rabbanā bi s-salām.",
        meaning: "O Allah, You are Peace and from You comes peace, so grant us life, our Lord, with peace.",
        notes: ""
      },
      {
        id: "tawaf-niyyah",
        section: "Tawaf",
        title: "Niyyah for Tawaf",
        arabic: "اَللَّهُمَّ إِنِّي أُرِيدُ طَوَافَ بَيْتِكَ الْحَرَامِ فَيَسِّرْهُ لِي وَتَقَبَّلْهُ مِنِّي",
        translit: "Allāhumma innī urīdu l-ṭawwafa baytika l-ḥarāmi fa yassirhu lī wa taqabbalhu minnī.",
        meaning: "O Allah, I intend to perform Tawaf of Your Sacred House, so make it easy for me and accept it from me.",
        notes: ""
      },
      {
        id: "hajar-salute",
        section: "Tawaf",
        title: "Saluting Hajar al-Aswad",
        arabic: "بِسْمِ اللّٰهِ وَاللّٰهُ أَكْبَرُ",
        translit: "Bismi Llāhi wa Llāhu akbar.",
        meaning: "In the name of Allah, Allah is the Greatest.",
        notes: ""
      },
      {
        id: "ali-dua",
        section: "Tawaf",
        title: "Du’a when parallel to Hajar al-Aswad",
        arabic: "بِسْمِ اللّٰهِ وَاللّٰهُ أَكْبَرُ ❁ اَللَّهُمَّ إِيمَاناً بِكَ وَتَصْدِيقاً بِكِتَابِكَ ❁ وَوَفَاءً بِعَهْدِكَ ❁ وَاتِّبَاعاً لِسُنَّةِ نَبِيِّكَ مُحَمَّدْ",
        translit: "Bismi Llāhi wa Llāhu akbar. Allāhumma īmānan bika wa taṣdīqan bi kitābik, wa wafāʿan bi ʿahdik, wattibāʿan li sunnati nabiyyika Muḥammad ﷺ.",
        meaning: "In the name of Allah, Allah is the Greatest. O Allah, (I do this) with faith in You, affirming the truth of Your Book, fulfilling Your covenant, and following the Sunnah of Your Prophet Muhammad ﷺ.",
        notes: ""
      },
      {
        id: "rukn-yamani",
        section: "Tawaf",
        title: "Between Rukn al-Yamani and Hajar al-Aswad",
        arabic: "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ",
        translit: "Rabbanā ātinā fi d-dunyā ḥasanatan wa fi l-ākhirati ḥasanatan wa qinā ʿadhāba n-nār.",
        meaning: "Our Lord, grant us good in this world and the Hereafter, and save us from the punishment of the Fire.",
        notes: "Qur’an 2:201"
      },
      {
        id: "maqam-verse",
        section: "Maqam Ibrahim",
        title: "Verse: take Maqam Ibrahim as a place of salah",
        arabic: "وَاتَّخِذُوا مِنْ مَقَامِ إِبْرَاهِيمَ مُصَلًّى",
        translit: "Wattakhidhū min maqāmi Ibrāhīma muṣalla.",
        meaning: "And take the Maqam Ibrahim as a place of prayer.",
        notes: "Qur’an 2:125"
      },
      {
        id: "zamzam",
        section: "Zamzam",
        title: "After drinking Zamzam",
        arabic: "اللّٰهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا ❁ وَرِزْقًا وَاسِعًا ❁ وَعَمَلًا مُتَقَبَّلًا ❁ وَشِفَاءً مِنْ كُلِّ دَاءٍ",
        translit: "Allāhumma innī as’aluka ʿilman nāfiʿa, wa rizqan wasiʿa, wa ʿamalan mutaqabbala, wa shifā’an min kulli dā’.",
        meaning: "O Allah, I ask You for beneficial knowledge, abundant provision, accepted deeds, and a cure for every illness.",
        notes: ""
      },
      {
        id: "sai-start",
        section: "Sa’i",
        title: "Starting Sa’i",
        arabic: "أَبْدَأُ بِمَا بَدَأَ اللهُ بِهِ",
        translit: "Abda’u bimā badā’ Llāhu bih.",
        meaning: "I begin with that which Allah has begun with.",
        notes: "Guide note: recite once before Sa’i."
      },
      {
        id: "safa-marwa",
        section: "Sa’i",
        title: "At Safa (repeat at Marwa) — recite x3 with your du’a between",
        arabic: "اللّٰهُ أَكْبَرُ ❁ اللّٰهُ أَكْبَرُ ❁ اللّٰهُ أَكْبَرُ ❁ وَلِلّٰهِ الْحَمْدُ\n\nلَآ إِلٰهَ إِلَّا اللّٰهُ وَحْدَهُ لاَ شَرِيكَ لَهُ ❁ لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ ❁ يُحْيِي وَيُمِيتُ ❁ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ\n\nلَآ إِلٰهَ إِلَّا اللّٰهُ وَحْدَهُ ❁ اَنْجَزَ وَعْدَهُ وَنَصَرَ عَبْدَهُ وَهَزَمَ اَلْأَحْزَابَ وَحْدَهُ",
        translit: "Allāhu akbar, Allāhu akbar, Allāhu akbar, wa li Llāhi l-ḥamd.\n\nLa ilāha illa Llāhu waḥdahu la sharīka lah, lahu l-mulku wa lahu l-ḥamd, yuḥīī wa yumīt, wa huwa ʿalā kulli shay’in qadīr.\n\nLa ilāha illa Llāhu waḥdah, anjaza waʿdahu wa naṣara ʿabdahu wa hazama l-aḥzāba waḥdah.",
        meaning: "Allah is the Greatest, Allah is the Greatest, Allah is the Greatest; and to Allah belongs all praise. There is no deity except Allah alone, without partner. To Him belongs the dominion and to Him belongs all praise. He gives life and causes death, and He has power over all things. There is no deity except Allah alone. He fulfilled His promise, supported His servant, and defeated the confederates alone.",
        notes: "Guide note: recite 3 times; make your own du’a in between."
      },
      {
        id: "leave-masjid",
        section: "Leaving the Haram",
        title: "Leaving Masjid al-Haram",
        arabic: "بِسْمِ اللهِ وَالصَّلَاةُ وَالسَّلَّامُ عَلَى رَسُولِ اللهِ ❁ اللّٰهُمَّ إِنِّي أَسْأَلُكَ مِنْ فَضْلِكَ",
        translit: "Bismi Llāhi wa ṣ-ṣalātu wa s-salāmu ʿalā rasūli Llāh. Allāhumma innī as’aluka min faḍlik.",
        meaning: "In the name of Allah, and prayers and peace be upon the Messenger of Allah. O Allah, I ask You from Your bounty.",
        notes: "Exit with the left foot."
      },
    ];

    // --- State ---
    const STORAGE = {
      theme: "umrah_duas_theme",
      favs: "umrah_duas_favs",
      arabicSize: "umrah_duas_arabic_size",
      bodySize: "umrah_duas_body_size",
      view: "umrah_duas_view" // all | favs
    };

    const el = (id)=>document.getElementById(id);
    const listEl = el("list");
    const chipsEl = el("chips");
    const toastEl = el("toast");
    const qEl = el("q");

    let favs = new Set(JSON.parse(localStorage.getItem(STORAGE.favs) || "[]"));
    let activeSection = "All";
    let viewMode = localStorage.getItem(STORAGE.view) || "all";

    // Theme
    const prefersLight = window.matchMedia && window.matchMedia("(prefers-color-scheme: light)").matches;
    const savedTheme = localStorage.getItem(STORAGE.theme);
    const theme = savedTheme || (prefersLight ? "light" : "dark");
    document.documentElement.dataset.theme = theme;
    el("themeToggle").textContent = theme === "light" ? "Light" : "Dark";

    // Font sizes
    const savedArabic = Number(localStorage.getItem(STORAGE.arabicSize));
    const savedBody = Number(localStorage.getItem(STORAGE.bodySize));
    if (savedArabic) document.documentElement.style.setProperty("--arabicSize", savedArabic + "px");
    if (savedBody) document.documentElement.style.setProperty("--bodySize", savedBody + "px");

    // Network indicator
    const netDot = el("netDot");
    const netText = el("netText");
    function updateNet(){
      const online = navigator.onLine;
      netDot.classList.toggle("online", online);
      netText.textContent = online
        ? "Online (cached for offline use when installed)"
        : "Offline (cached content should still work)";
    }
    window.addEventListener("online", updateNet);
    window.addEventListener("offline", updateNet);
    updateNet();

    // Sections (chips)
    const sections = ["All", ...Array.from(new Set(DUAS.map(d=>d.section)))];
    function renderChips(){
      chipsEl.innerHTML = "";
      sections.forEach(sec=>{
        const c = document.createElement("div");
        c.className = "chip";
        c.textContent = sec;
        c.dataset.active = (sec === activeSection) ? "true" : "false";
        c.addEventListener("click", ()=>{
          activeSection = sec;
          renderChips();
          render();
        });
        chipsEl.appendChild(c);
      });
    }

    // Helpers
    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=>toastEl.classList.remove("show"), 1200);
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        toast("Copied ✅");
      }catch{
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast("Copied ✅");
      }
    }

    function heartIcon(filled){
      return filled
        ? `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 21s-7.2-4.6-9.5-8.4C.3 9.2 2.2 5.8 5.9 5.2c2-.3 3.6.6 4.5 1.8.9-1.2 2.5-2.1 4.5-1.8 3.7.6 5.6 4 3.4 7.4C19.2 16.4 12 21 12 21z"/></svg>`
        : `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 21s-7.2-4.6-9.5-8.4C.3 9.2 2.2 5.8 5.9 5.2c2-.3 3.6.6 4.5 1.8.9-1.2 2.5-2.1 4.5-1.8 3.7.6 5.6 4 3.4 7.4C19.2 16.4 12 21 12 21z" stroke="currentColor" stroke-width="2"/></svg>`;
    }

    function copyIcon(){
      return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/>
        <path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/>
      </svg>`;
    }

    function filterDuas(){
      const query = (qEl.value || "").trim().toLowerCase();

      return DUAS.filter(d=>{
        if (viewMode === "favs" && !favs.has(d.id)) return false;
        if (activeSection !== "All" && d.section !== activeSection) return false;
        if (!query) return true;

        const hay = [
          d.section, d.title, d.arabic, d.translit, d.meaning, d.notes
        ].join(" ").toLowerCase();

        return hay.includes(query);
      });
    }

    function render(){
      const items = filterDuas();
      listEl.innerHTML = "";

      if (!items.length){
        const div = document.createElement("div");
        div.className = "empty";
        div.innerHTML = `<strong>No matches.</strong><div style="margin-top:6px">Try a different word (e.g. “zamzam”, “tawaf”, “mercy”).</div>`;
        listEl.appendChild(div);
        return;
      }

      items.forEach(d=>{
        const card = document.createElement("div");
        card.className = "card";

        const isFav = favs.has(d.id);

        card.innerHTML = `
          <div class="cardTop">
            <div class="meta">
              <div class="section">${escapeHtml(d.section)}</div>
              <h3 class="title">${escapeHtml(d.title)}</h3>
            </div>
            <div class="actions">
              <div class="iconBtn" data-action="copy" title="Copy Arabic + Transliteration + Meaning">
                ${copyIcon()}
              </div>
              <div class="iconBtn" data-action="fav" title="Favourite">
                ${heartIcon(isFav)}
              </div>
            </div>
          </div>

          <div class="content">
            <div class="label">Arabic</div>
            <p class="arabic">${formatArabic(d.arabic)}</p>

            <div class="label">Transliteration</div>
            <p class="text">${escapeHtml(d.translit || "—")}</p>

            <div class="label">Meaning</div>
            <p class="text">${escapeHtml(d.meaning || "—")}</p>

            ${d.notes ? `<div class="notes"><strong>Note:</strong> ${escapeHtml(d.notes)}</div>` : ``}
          </div>
        `;

        // Actions
        card.querySelector('[data-action="fav"]').addEventListener("click", ()=>{
          if (favs.has(d.id)) favs.delete(d.id); else favs.add(d.id);
          localStorage.setItem(STORAGE.favs, JSON.stringify(Array.from(favs)));
          render();
          toast(favs.has(d.id) ? "Saved to Favourites ❤️" : "Removed");
        });

        card.querySelector('[data-action="copy"]').addEventListener("click", ()=>{
          const text = [
            d.title,
            `Arabic:\n${d.arabic.replaceAll("❁","").trim()}`,
            `Transliteration:\n${d.translit || ""}`,
            `Meaning:\n${d.meaning || ""}`,
            d.notes ? `Note:\n${d.notes}` : ""
          ].filter(Boolean).join("\n\n");
          copyText(text);
        });

        listEl.appendChild(card);
      });
    }

    function formatArabic(str){
      return escapeHtml(str).replace(/\n/g, "<br/>");
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, c=>({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    // Search
    qEl.addEventListener("input", ()=> render());

    // Theme toggle
    el("themeToggle").addEventListener("click", ()=>{
      const cur = document.documentElement.dataset.theme;
      const next = cur === "light" ? "dark" : "light";
      document.documentElement.dataset.theme = next;
      localStorage.setItem(STORAGE.theme, next);
      el("themeToggle").textContent = next === "light" ? "Light" : "Dark";
      toast(next === "light" ? "Light mode" : "Dark mode");
    });

    // Font size controls
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
    function getPxVar(name){
      return Number(getComputedStyle(document.documentElement).getPropertyValue(name).replace("px","").trim());
    }
    function setPxVar(name, value, storageKey){
      document.documentElement.style.setProperty(name, value + "px");
      localStorage.setItem(storageKey, String(value));
      render();
    }

    el("arabicMinus").addEventListener("click", ()=>{
      const cur = getPxVar("--arabicSize");
      setPxVar("--arabicSize", clamp(cur - 2, 16, 34), STORAGE.arabicSize);
      toast("Arabic size ↓");
    });
    el("arabicPlus").addEventListener("click", ()=>{
      const cur = getPxVar("--arabicSize");
      setPxVar("--arabicSize", clamp(cur + 2, 16, 34), STORAGE.arabicSize);
      toast("Arabic size ↑");
    });
    el("bodyMinus").addEventListener("click", ()=>{
      const cur = getPxVar("--bodySize");
      setPxVar("--bodySize", clamp(cur - 1, 12, 18), STORAGE.bodySize);
      toast("Text size ↓");
    });
    el("bodyPlus").addEventListener("click", ()=>{
      const cur = getPxVar("--bodySize");
      setPxVar("--bodySize", clamp(cur + 1, 12, 18), STORAGE.bodySize);
      toast("Text size ↑");
    });

    // View mode
    el("showFavs").addEventListener("click", ()=>{
      viewMode = "favs";
      localStorage.setItem(STORAGE.view, viewMode);
      toast("Showing favourites");
      render();
    });
    el("showAll").addEventListener("click", ()=>{
      viewMode = "all";
      localStorage.setItem(STORAGE.view, viewMode);
      toast("Showing all");
      render();
    });

    // Init
    renderChips();
    render();

    // Service worker (offline cache)
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(()=>{});
      });
    }
  </script>
</body>
</html>
